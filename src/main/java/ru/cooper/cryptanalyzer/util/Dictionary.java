package ru.cooper.cryptanalyzer.util;

import java.util.Arrays;
import java.util.Set;
import java.util.HashSet;

/**
 * Содержит набор часто используемых русских слов для анализа текста.
 * <p>
 * Используется в алгоритмах криптоанализа для определения степени осмысленности
 * расшифрованного текста. Слова сгруппированы по частям речи и частоте использования.
 * <p>
 * Класс является утилитарным - все методы и поля статические, создание экземпляров запрещено.
 */
public final class Dictionary {

    /**
     * Неизменяемое множество наиболее употребительных русских слов.
     * <p>
     * Включает:
     * <ul>
     *   <li>Местоимения и частицы</li>
     *   <li>Предлоги и союзы</li>
     *   <li>Вопросительные слова</li>
     *   <li>Глаголы и их формы</li>
     *   <li>Существительные</li>
     *   <li>Прилагательные</li>
     *   <li>Числительные</li>
     *   <li>Наречия</li>
     *   <li>Современные термины</li>
     * </ul>
     *
     * @see #initCommonWords()
     */
    public static final Set<String> COMMON_RUSSIAN_WORDS = initCommonWords();

    private Dictionary() {
        throw new UnsupportedOperationException("Это служебный класс и не может быть инстанциирован");
    }

    /**
     * Инициализирует и возвращает набор часто используемых русских слов.
     * <p>
     * Слова добавлены вручную на основе частотности использования в русском языке.
     *
     * @return неизменяемый набор русских слов
     */
    private static Set<String> initCommonWords() {
        Set<String> words = new HashSet<>(200);

        // Местоимения и частицы
        addWords(words, "я", "ты", "он", "она", "мы", "вы", "они",
                "это", "то", "все", "что", "как", "так", "да", "нет");

        // Предлоги и союзы
        addWords(words, "в", "на", "с", "по", "за", "из", "от", "до", "для",
                "и", "а", "но", "или", "если", "чтобы", "когда", "потому");

        // Вопросы
        addWords(words, "кто", "что", "где", "куда", "откуда", "почему", "зачем", "какой");

        // Приветствия и общение
        addWords(words, "привет", "здравствуй", "здравствуйте", "добрый",
                "утро", "вечер", "спасибо", "пожалуйста", "извини",
                "прости", "пока", "свидания");

        // Глаголы
        addWords(words, "быть", "есть", "был", "была", "было", "стать",
                "сказать", "говорить", "знать", "хотеть", "мочь", "делать",
                "идти", "прийти", "видеть", "смотреть", "любить", "жить",
                "работать", "думать", "понимать", "ждать", "дать", "взять");

        // Существительные
        addWords(words, "человек", "мужчина", "женщина", "ребенок", "друг",
                "мать", "отец", "брат", "сестра", "семья", "имя", "время",
                "день", "год", "работа", "дом", "жизнь");

        // Прилагательные
        addWords(words, "хороший", "плохой", "новый", "старый", "большой",
                "маленький", "должный", "первый", "последний", "русский",
                "другой", "каждый", "самый", "весь");

        // Числительные
        addWords(words, "один", "два", "три", "четыре", "пять", "десять",
                "сто", "тысяча");

        // Наречия
        addWords(words, "здесь", "там", "тут", "сейчас", "тогда", "очень",
                "много", "мало", "хорошо", "плохо", "быстро", "медленно",
                "вместе", "снова", "почти", "уже");

        // Современные слова
        addWords(words, "компьютер", "телефон", "интернет", "программа",
                "файл", "сообщение", "пароль");

        return Set.copyOf(words);
    }

    /**
     * Вспомогательный метод для добавления группы слов в набор.
     * <p>
     * Добавляет все переданные слова в указанный набор. Если массив слов пуст,
     * метод не оказывает никакого эффекта.
     *
     * @param words набор для добавления (должен быть изменяемым)
     * @param items слова для добавления (может быть пустым)
     */
    private static void addWords(Set<String> words, String... items) {
        words.addAll(Arrays.asList(items));
    }
}
